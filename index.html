<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CortisolCare - Stress Reduction & Habit Tracking</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #f0f4ff 0%, #e0e7ff 100%); min-height: 100vh; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .header { background: white; border-radius: 15px; padding: 30px; margin-bottom: 30px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); border-bottom: 4px solid #4f46e5; }
        .header h1 { font-size: 2.5rem; color: #1f2937; margin-bottom: 10px; display: flex; align-items: center; gap: 15px; }
        .header p { color: #6b7280; font-size: 1.1rem; }
        .uk-badge { background: #eef2ff; color: #4f46e5; padding: 8px 16px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; }
        .auth-section { background: #fef3c7; border: 2px solid #f59e0b; border-radius: 15px; padding: 25px; margin-bottom: 30px; display: flex; align-items: center; gap: 20px; }
        .auth-section h3 { color: #92400e; font-size: 1.3rem; margin-bottom: 5px; }
        .auth-section p { color: #b45309; }
        .btn { padding: 12px 24px; border-radius: 10px; border: none; font-weight: 600; cursor: pointer; transition: all 0.3s; }
        .btn-primary { background: #4f46e5; color: white; }
        .btn-primary:hover { background: #4338ca; }
        .btn-warning { background: #f59e0b; color: white; }
        .btn-warning:hover { background: #d97706; }
        .lang-switcher { display: flex; background: #f3f4f6; border-radius: 10px; padding: 4px; gap: 4px; margin-bottom: 20px; }
        .lang-btn { padding: 8px 16px; border: none; background: transparent; border-radius: 6px; cursor: pointer; font-weight: 600; transition: all 0.3s; }
        .lang-btn.active { background: white; color: #1f2937; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .lang-btn:not(.active) { color: #6b7280; }
        .category { background: white; border-radius: 15px; margin-bottom: 25px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .category-header { padding: 25px; color: white; font-size: 1.3rem; font-weight: 700; display: flex; justify-content: between; align-items: center; }
        .category-content { padding: 30px; }
        .habits-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px; }
        .habit-item { display: flex; align-items: center; padding: 18px; background: #f9fafb; border: 2px solid #e5e7eb; border-radius: 12px; cursor: pointer; transition: all 0.3s; }
        .habit-item:hover { border-color: #d1d5db; }
        .habit-item.completed { background: #f0fdf4; border-color: #86efac; color: #166534; }
        .checkbox { width: 24px; height: 24px; border: 2px solid #d1d5db; border-radius: 50%; margin-right: 15px; display: flex; align-items: center; justify-content: center; transition: all 0.3s; }
        .habit-item.completed .checkbox { background: #22c55e; border-color: #22c55e; color: white; }
        .progress-bar { background: #e5e7eb; height: 8px; border-radius: 4px; overflow: hidden; margin-bottom: 10px; }
        .progress-fill { height: 100%; background: #22c55e; transition: width 0.5s ease; }
        .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: white; padding: 25px; border-radius: 15px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .stat-number { font-size: 2.5rem; font-weight: 800; margin-bottom: 5px; }
        .stat-label { color: #6b7280; font-size: 0.9rem; }
        .green { background: #f0fdf4; } .green .stat-number { color: #22c55e; }
        .orange { background: #fff7ed; } .orange .stat-number { color: #ea580c; }
        .blue { background: #eff6ff; } .blue .stat-number { color: #2563eb; }
        .purple { background: #faf5ff; } .purple .stat-number { color: #9333ea; }
        .nutrition { background: #22c55e; }
        .sleep { background: #4f46e5; }
        .exercise { background: #ea580c; }
        .warmth { background: #ec4899; }
        .breathing { background: #06b6d4; }
        .digital { background: #8b5cf6; }
        .social { background: #ef4444; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center; }
        .modal.show { display: flex; }
        .modal-content { background: white; border-radius: 15px; padding: 40px; max-width: 500px; width: 90%; position: relative; }
        .modal h2 { text-align: center; margin-bottom: 20px; color: #1f2937; }
        .form-group { margin-bottom: 20px; }
        .form-input { width: 100%; padding: 15px; border: 2px solid #e5e7eb; border-radius: 10px; font-size: 1rem; }
        .form-input:focus { outline: none; border-color: #4f46e5; }
        .close-btn { position: absolute; top: 15px; right: 20px; background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #6b7280; }
        .footer { text-align: center; margin-top: 50px; color: #6b7280; }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div style="display: flex; justify-content: space-between; align-items: flex-start; flex-wrap: wrap; gap: 20px;">
                <div>
                    <h1>
                        ðŸ§  <span id="app-title">CortisolCare</span>
                        <span class="uk-badge" id="uk-badge">ðŸ‡¬ðŸ‡§ Made in UK</span>
                    </h1>
                    <p id="app-subtitle">Your journey to stress reduction and better wellbeing</p>
                </div>
                <div style="display: flex; align-items: center; gap: 15px;">
                    <div class="lang-switcher">
                        <button class="lang-btn active" onclick="setLanguage('en')">ðŸ‡¬ðŸ‡§ EN</button>
                        <button class="lang-btn" onclick="setLanguage('ru')">ðŸ‡·ðŸ‡º RU</button>
                    </div>
                    <button class="btn btn-primary" onclick="showAuth()" id="auth-btn">ðŸ”‘ Sign In</button>
                </div>
            </div>
        </div>

        <!-- Auth Prompt -->
        <div class="auth-section" id="auth-prompt">
            <div>
                <h3 id="auth-prompt-title">Sign in to save your progress</h3>
                <p id="auth-prompt-desc">Create an account or sign in to track habits and view statistics.</p>
            </div>
            <button class="btn btn-warning" onclick="showAuth()" id="register-btn">âž• Register</button>
        </div>

        <!-- Date Selector -->
        <div class="category">
            <div class="category-header" style="background: #4f46e5;">
                <div style="display: flex; align-items: center;">
                    <span style="margin-right: 15px;">ðŸ“…</span>
                    <input type="date" id="current-date" style="background: transparent; border: none; color: white; font-size: 1.2rem; font-weight: 600;">
                </div>
                <button class="btn" style="background: rgba(255,255,255,0.2); color: white;" onclick="toggleStats()" id="stats-btn">ðŸ“Š Statistics</button>
            </div>
        </div>

        <!-- Statistics -->
        <div class="stats" id="stats-section" style="display: none;">
            <div class="stat-card green">
                <div class="stat-number" id="total-progress">0%</div>
                <div class="stat-label" id="today-label">Today</div>
            </div>
            <div class="stat-card orange">
                <div class="stat-number" id="streak-days">0</div>
                <div class="stat-label" id="streak-label">days streak</div>
            </div>
            <div class="stat-card blue">
                <div class="stat-number">28</div>
                <div class="stat-label" id="habits-label">Total habits</div>
            </div>
            <div class="stat-card purple">
                <div class="stat-number">7</div>
                <div class="stat-label" id="categories-label">Categories</div>
            </div>
        </div>

        <!-- Habit Categories -->
        <div id="habits-container"></div>

        <!-- Tip Section -->
        <div class="category">
            <div class="category-header" style="background: linear-gradient(135deg, #4f46e5, #8b5cf6);">
                <h3 id="tip-title">ðŸ’¡ Daily Tip</h3>
            </div>
            <div class="category-content">
                <p id="tip-text" style="color: #4b5563; line-height: 1.6;">
                    Cortisol is the stress hormone. Regular practice of these habits will help naturally reduce its levels. 
                    Particularly effective: deep breathing, hugs, quality sleep and moderate physical activity.
                </p>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p id="footer-text">Â© 2025 CortisolCare - Your health in your hands</p>
            <p id="footer-sub">UK-based wellness technology</p>
        </div>
    </div>

    <!-- Auth Modal -->
    <div class="modal" id="auth-modal">
        <div class="modal-content">
            <button class="close-btn" onclick="hideAuth()">âœ•</button>
            <h2 id="modal-title">Sign in to your account</h2>
            <form onsubmit="handleAuth(event)">
                <div class="form-group" id="name-group" style="display: none;">
                    <input type="text" class="form-input" id="name-input" placeholder="Your name">
                </div>
                <div class="form-group">
                    <input type="email" class="form-input" id="email-input" placeholder="Email" required>
                </div>
                <div class="form-group">
                    <input type="password" class="form-input" id="password-input" placeholder="Password" required>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%; margin-bottom: 15px;" id="submit-btn">Sign In</button>
            </form>
            <div style="text-align: center;">
                <button onclick="switchAuthMode()" style="background: none; border: none; color: #4f46e5; cursor: pointer;" id="switch-btn">
                    Don't have an account? Sign up
                </button>
            </div>
        </div>
    </div>

    <script>
        let currentLanguage = 'en';
        let currentUser = null;
        let habits = {};
        let authMode = 'login';
        let showingStats = false;
        
        const translations = {
            en: {
                appTitle: "CortisolCare",
                appSubtitle: "Your journey to stress reduction and better wellbeing",
                authBtn: "ðŸ”‘ Sign In",
                registerBtn: "âž• Register",
                authPromptTitle: "Sign in to save your progress",
                authPromptDesc: "Create an account or sign in to track habits and view statistics.",
                statsBtn: "ðŸ“Š Statistics",
                todayLabel: "Today",
                streakLabel: "days streak",
                habitsLabel: "Total habits",
                categoriesLabel: "Categories",
                tipTitle: "ðŸ’¡ Daily Tip",
                tipText: "Cortisol is the stress hormone. Regular practice of these habits will help naturally reduce its levels. Particularly effective: deep breathing, hugs, quality sleep and moderate physical activity.",
                footerText: "Â© 2025 CortisolCare - Your health in your hands",
                footerSub: "UK-based wellness technology",
                ukBadge: "ðŸ‡¬ðŸ‡§ Made in UK",
                loginTitle: "Sign in to your account",
                registerTitle: "Create your account",
                name: "Your name",
                email: "Email",
                password: "Password",
                signIn: "Sign In",
                signUp: "Sign Up",
                noAccount: "Don't have an account? Sign up",
                hasAccount: "Already have an account? Sign in",
                categories: {
                    nutrition: { name: "Nutrition", items: ["Breakfast before 9 AM", "Lunch without rush", "8 glasses of water", "Dinner 3h before bed"] },
                    sleep: { name: "Sleep", items: ["Bed before 11 PM", "Slept 7-8 hours", "Woke up rested", "No screens 1h before bed"] },
                    exercise: { name: "Activity", items: ["Morning exercise", "30 min walk", "Stretching", "Strength training"] },
                    warmth: { name: "Warmth & Comfort", items: ["Hugs (5+ min)", "Warm socks", "Cozy environment", "Warm bath/shower"] },
                    breathing: { name: "Breathing & Peace", items: ["Breathing practice", "10 min meditation", "Silence and peace", "Gratitude practice"] },
                    digital: { name: "Digital Detox", items: ["No phone 1h morning", "No social media before lunch", "'Do not disturb' mode", "Offline time evening"] },
                    social: { name: "Emotional Support", items: ["Talk with loved ones", "Pleasant conversation", "Support others", "Time for yourself"] }
                }
            },
            ru: {
                appTitle: "ÐšÐ¾Ñ€Ñ‚Ð¸Ð·Ð¾Ð»Ð¢Ñ€ÐµÐºÐµÑ€",
                appSubtitle: "Ð’Ð°Ñˆ Ð¿ÑƒÑ‚ÑŒ Ðº ÑÐ½Ð¸Ð¶ÐµÐ½Ð¸ÑŽ ÑÑ‚Ñ€ÐµÑÑÐ° Ð¸ ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð¸ÑŽ ÑÐ°Ð¼Ð¾Ñ‡ÑƒÐ²ÑÑ‚Ð²Ð¸Ñ",
                authBtn: "ðŸ”‘ Ð’Ð¾Ð¹Ñ‚Ð¸",
                registerBtn: "âž• Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ",
                authPromptTitle: "Ð’Ð¾Ð¹Ð´Ð¸Ñ‚Ðµ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ ÑÐ¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑ",
                authPromptDesc: "Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚ Ð¸Ð»Ð¸ Ð²Ð¾Ð¹Ð´Ð¸Ñ‚Ðµ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¾Ñ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¸Ð²Ñ‹Ñ‡ÐºÐ¸ Ð¸ Ð²Ð¸Ð´ÐµÑ‚ÑŒ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÑƒ.",
                statsBtn: "ðŸ“Š Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°",
                todayLabel: "Ð¡ÐµÐ³Ð¾Ð´Ð½Ñ",
                streakLabel: "Ð´Ð½ÐµÐ¹ Ð¿Ð¾Ð´Ñ€ÑÐ´",
                habitsLabel: "Ð’ÑÐµÐ³Ð¾ Ð¿Ñ€Ð¸Ð²Ñ‹Ñ‡ÐµÐº",
                categoriesLabel: "ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹",
                tipTitle: "ðŸ’¡ Ð¡Ð¾Ð²ÐµÑ‚ Ð´Ð½Ñ",
                tipText: "ÐšÐ¾Ñ€Ñ‚Ð¸Ð·Ð¾Ð» - ÑÑ‚Ð¾ Ð³Ð¾Ñ€Ð¼Ð¾Ð½ ÑÑ‚Ñ€ÐµÑÑÐ°. Ð ÐµÐ³ÑƒÐ»ÑÑ€Ð½Ð¾Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ ÑÑ‚Ð¸Ñ… Ð¿Ñ€Ð¸Ð²Ñ‹Ñ‡ÐµÐº Ð¿Ð¾Ð¼Ð¾Ð¶ÐµÑ‚ ÐµÑÑ‚ÐµÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¼ Ð¾Ð±Ñ€Ð°Ð·Ð¾Ð¼ ÑÐ½Ð¸Ð·Ð¸Ñ‚ÑŒ ÐµÐ³Ð¾ ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ. ÐžÑÐ¾Ð±ÐµÐ½Ð½Ð¾ ÑÑ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ñ‹: Ð³Ð»ÑƒÐ±Ð¾ÐºÐ¾Ðµ Ð´Ñ‹Ñ…Ð°Ð½Ð¸Ðµ, Ð¾Ð±ÑŠÑÑ‚Ð¸Ñ, ÐºÐ°Ñ‡ÐµÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¹ ÑÐ¾Ð½ Ð¸ ÑƒÐ¼ÐµÑ€ÐµÐ½Ð½Ð°Ñ Ñ„Ð¸Ð·Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ.",
                footerText: "Â© 2025 ÐšÐ¾Ñ€Ñ‚Ð¸Ð·Ð¾Ð»ÐšÐµÐ° - Ð’Ð°ÑˆÐµ Ð·Ð´Ð¾Ñ€Ð¾Ð²ÑŒÐµ Ð² Ð²Ð°ÑˆÐ¸Ñ… Ñ€ÑƒÐºÐ°Ñ…",
                footerSub: "Ð‘Ñ€Ð¸Ñ‚Ð°Ð½ÑÐºÐ¸Ðµ Ð²ÐµÐ»Ð½ÐµÑ Ñ‚ÐµÑ…Ð½Ð¾Ð»Ð¾Ð³Ð¸Ð¸",
                ukBadge: "ðŸ‡¬ðŸ‡§ Ð¡Ð´ÐµÐ»Ð°Ð½Ð¾ Ð² Ð’ÐµÐ»Ð¸ÐºÐ¾Ð±Ñ€Ð¸Ñ‚Ð°Ð½Ð¸Ð¸",
                loginTitle: "Ð’Ñ…Ð¾Ð´ Ð² Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚",
                registerTitle: "Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚Ð°",
                name: "Ð’Ð°ÑˆÐµ Ð¸Ð¼Ñ",
                email: "Email",
                password: "ÐŸÐ°Ñ€Ð¾Ð»ÑŒ",
                signIn: "Ð’Ð¾Ð¹Ñ‚Ð¸",
                signUp: "Ð—Ð°Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒÑÑ",
                noAccount: "ÐÐµÑ‚ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚Ð°? Ð—Ð°Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€ÑƒÐ¹Ñ‚ÐµÑÑŒ",
                hasAccount: "Ð£Ð¶Ðµ ÐµÑÑ‚ÑŒ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚? Ð’Ð¾Ð¹Ð´Ð¸Ñ‚Ðµ",
                categories: {
                    nutrition: { name: "ÐŸÐ¸Ñ‚Ð°Ð½Ð¸Ðµ", items: ["Ð—Ð°Ð²Ñ‚Ñ€Ð°Ðº Ð´Ð¾ 9:00", "ÐžÐ±ÐµÐ´ Ð±ÐµÐ· ÑÐ¿ÐµÑˆÐºÐ¸", "8 ÑÑ‚Ð°ÐºÐ°Ð½Ð¾Ð² Ð²Ð¾Ð´Ñ‹", "Ð£Ð¶Ð¸Ð½ Ð·Ð° 3Ñ‡ Ð´Ð¾ ÑÐ½Ð°"] },
                    sleep: { name: "Ð¡Ð¾Ð½", items: ["Ð›Ñ‘Ð³ Ð´Ð¾ 23:00", "ÐŸÑ€Ð¾ÑÐ¿Ð°Ð» 7-8 Ñ‡Ð°ÑÐ¾Ð²", "ÐŸÑ€Ð¾ÑÐ½ÑƒÐ»ÑÑ Ð¾Ñ‚Ð´Ð¾Ñ…Ð½ÑƒÐ²ÑˆÐ¸Ð¼", "Ð‘ÐµÐ· ÑÐºÑ€Ð°Ð½Ð¾Ð² Ð·Ð° Ñ‡Ð°Ñ Ð´Ð¾ ÑÐ½Ð°"] },
                    exercise: { name: "ÐÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ", items: ["Ð£Ñ‚Ñ€ÐµÐ½Ð½ÑÑ Ð·Ð°Ñ€ÑÐ´ÐºÐ°", "30 Ð¼Ð¸Ð½ Ð¿Ñ€Ð¾Ð³ÑƒÐ»ÐºÐ¸", "Ð Ð°ÑÑ‚ÑÐ¶ÐºÐ°", "Ð¡Ð¸Ð»Ð¾Ð²Ð°Ñ Ñ‚Ñ€ÐµÐ½Ð¸Ñ€Ð¾Ð²ÐºÐ°"] },
                    warmth: { name: "Ð¢ÐµÐ¿Ð»Ð¾ Ð¸ ÑƒÑŽÑ‚", items: ["ÐžÐ±ÑŠÑÑ‚Ð¸Ñ (5+ Ð¼Ð¸Ð½)", "Ð¢Ñ‘Ð¿Ð»Ñ‹Ðµ Ð½Ð¾ÑÐ¾Ñ‡ÐºÐ¸", "Ð£ÑŽÑ‚Ð½Ð°Ñ Ð¾Ð±ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ°", "Ð¢Ñ‘Ð¿Ð»Ð°Ñ Ð²Ð°Ð½Ð½Ð°/Ð´ÑƒÑˆ"] },
                    breathing: { name: "Ð”Ñ‹Ñ…Ð°Ð½Ð¸Ðµ Ð¸ Ð¿Ð¾ÐºÐ¾Ð¹", items: ["Ð”Ñ‹Ñ…Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ°", "10 Ð¼Ð¸Ð½ Ð¼ÐµÐ´Ð¸Ñ‚Ð°Ñ†Ð¸Ð¸", "Ð¢Ð¸ÑˆÐ¸Ð½Ð° Ð¸ Ð¿Ð¾ÐºÐ¾Ð¹", "ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÐ° Ð±Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€Ð½Ð¾ÑÑ‚Ð¸"] },
                    digital: { name: "Ð¦Ð¸Ñ„Ñ€Ð¾Ð²Ð¾Ð¹ Ð´ÐµÑ‚Ð¾ÐºÑ", items: ["Ð‘ÐµÐ· Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ð° 1Ñ‡ ÑƒÑ‚Ñ€Ð¾Ð¼", "Ð‘ÐµÐ· ÑÐ¾Ñ†ÑÐµÑ‚ÐµÐ¹ Ð´Ð¾ Ð¾Ð±ÐµÐ´Ð°", "Ð ÐµÐ¶Ð¸Ð¼ 'ÐÐµ Ð±ÐµÑÐ¿Ð¾ÐºÐ¾Ð¸Ñ‚ÑŒ'", "ÐžÑ„Ð»Ð°Ð¹Ð½ Ð²Ñ€ÐµÐ¼Ñ Ð²ÐµÑ‡ÐµÑ€Ð¾Ð¼"] },
                    social: { name: "Ð­Ð¼Ð¾Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð°Ñ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ°", items: ["ÐžÐ±Ñ‰ÐµÐ½Ð¸Ðµ Ñ Ð±Ð»Ð¸Ð·ÐºÐ¸Ð¼Ð¸", "ÐŸÑ€Ð¸ÑÑ‚Ð½Ð¾Ðµ Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ", "ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° Ð´Ñ€ÑƒÐ³Ð¸Ñ…", "Ð’Ñ€ÐµÐ¼Ñ Ð´Ð»Ñ ÑÐµÐ±Ñ"] }
                }
            }
        };

        function setLanguage(lang) {
            currentLanguage = lang;
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            updateUI();
        }

        function updateUI() {
            const t = translations[currentLanguage];
            
            document.getElementById('app-title').textContent = t.appTitle;
            document.getElementById('app-subtitle').textContent = t.appSubtitle;
            document.getElementById('uk-badge').textContent = t.ukBadge;
            document.getElementById('auth-btn').innerHTML = t.authBtn;
            document.getElementById('register-btn').innerHTML = t.registerBtn;
            document.getElementById('auth-prompt-title').textContent = t.authPromptTitle;
            document.getElementById('auth-prompt-desc').textContent = t.authPromptDesc;
            document.getElementById('stats-btn').innerHTML = t.statsBtn;
            document.getElementById('today-label').textContent = t.todayLabel;
            document.getElementById('streak-label').textContent = t.streakLabel;
            document.getElementById('habits-label').textContent = t.habitsLabel;
            document.getElementById('categories-label').textContent = t.categoriesLabel;
            document.getElementById('tip-title').innerHTML = t.tipTitle;
            document.getElementById('tip-text').textContent = t.tipText;
            document.getElementById('footer-text').textContent = t.footerText;
            document.getElementById('footer-sub').textContent = t.footerSub;
            
            renderCategories();
            updateStats();
        }

        function renderCategories() {
            const container = document.getElementById('habits-container');
            const t = translations[currentLanguage];
            const categories = ['nutrition', 'sleep', 'exercise', 'warmth', 'breathing', 'digital', 'social'];
            const colors = ['nutrition', 'sleep', 'exercise', 'warmth', 'breathing', 'digital', 'social'];
            const icons = ['â˜•', 'ðŸŒ™', 'ðŸ‹ï¸', 'ðŸŒ¡ï¸', 'ðŸ’¨', 'ðŸ“±', 'â¤ï¸'];
            
            container.innerHTML = '';
            
            categories.forEach((catId, index) => {
                const category = t.categories[catId];
                const progress = getCategoryProgress(catId);
                
                const categoryHTML = `
                    <div class="category">
                        <div class="category-header ${colors[index]}">
                            <div style="display: flex; align-items: center;">
                                <span style="margin-right: 15px; font-size: 1.5rem;">${icons[index]}</span>
                                <h3>${category.name}</h3>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-size: 1.5rem; font-weight: 800;">${progress}%</div>
                                <div style="font-size: 0.9rem; opacity: 0.9;">Completed</div>
                            </div>
                        </div>
                        <div class="category-content">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${progress}%"></div>
                            </div>
                            <div class="habits-grid">
                                ${category.items.map((item, itemIndex) => `
                                    <div class="habit-item ${getHabitStatus(catId, itemIndex) ? 'completed' : ''}" 
                                         onclick="toggleHabit('${catId}', ${itemIndex})">
                                        <div class="checkbox">
                                            ${getHabitStatus(catId, itemIndex) ? 'âœ“' : ''}
                                        </div>
                                        <span>${item}</span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
                
                container.innerHTML += categoryHTML;
            });
        }

        function toggleHabit(categoryId, itemIndex) {
            if (!currentUser) {
                showAuth();
                return;
            }
            
            const currentDate = document.getElementById('current-date').value;
            const key = `${currentUser.id}-${currentDate}-${categoryId}-${itemIndex}`;
            habits[key] = !habits[key];
            localStorage.setItem('cortisol-habits', JSON.stringify(habits));
            renderCategories();
            updateStats();
        }

        function getHabitStatus(categoryId, itemIndex) {
            if (!currentUser) return false;
            const currentDate = document.getElementById('current-date').value;
            const key = `${currentUser.id}-${currentDate}-${categoryId}-${itemIndex}`;
            return habits[key] || false;
        }

        function getCategoryProgress(categoryId) {
            const t = translations[currentLanguage];
            const category = t.categories[categoryId];
            const completed = category.items.filter((_, index) => getHabitStatus(categoryId, index)).length;
            return Math.round((completed / category.items.length) * 100);
        }

        function getTotalProgress() {
            const t = translations[currentLanguage];
            const categories = Object.keys(t.categories);
            let totalItems = 0;
            let completedItems = 0;
            
            categories.forEach(catId => {
                const category = t.categories[catId];
                totalItems += category.items.length;
                completedItems += category.items.filter((_, index) => getHabitStatus(catId, index)).length;
            });
            
            return totalItems > 0 ? Math.round((completedItems / totalItems) * 100) : 0;
        }

        function getStreakDays() {
            if (!currentUser) return 0;
            // Simplified streak calculation
            return Math.floor(Math.random() * 10); // Placeholder
        }

        function updateStats() {
            document.getElementById('total-progress').textContent = getTotalProgress() + '%';
            document.getElementById('streak-days').textContent = getStreakDays();
        }

        function showAuth() {
            document.getElementById('auth-modal').classList.add('show');
        }

        function hideAuth() {
            document.getElementById('auth-modal').classList.remove('show');
        }

        function switchAuthMode() {
            authMode = authMode === 'login' ? 'register' : 'login';
            const t = translations[currentLanguage];
            
            if (authMode === 'register') {
                document.getElementById('modal-title').textContent = t.registerTitle;
                document.getElementById('submit-btn').textContent = t.signUp;
                document.getElementById('switch-btn').textContent = t.hasAccount;
                document.getElementById('name-group').style.display = 'block';
                document.getElementById('name-input').placeholder = t.name;
            } else {
                document.getElementById('modal-title').textContent = t.loginTitle;
                document.getElementById('submit-btn').textContent = t.signIn;
                document.getElementById('switch-btn').textContent = t.noAccount;
                document.getElementById('name-group').style.display = 'none';
            }
            
            document.getElementById('email-input').placeholder = t.email;
            document.getElementById('password-input').placeholder = t.password;
        }

        function handleAuth(event) {
            event.preventDefault();
            
            const email = document.getElementById('email-input').value;
            const password = document.getElementById('password-input').value;
            const name = document.getElementById('name-input').value;
            
            currentUser = {
                id: Date.now(),
                email: email,
                name: name || email.split('@')[0],
                subscription: 'free',
                joinDate: new Date().toISOString()
            };
            
            localStorage.setItem('cortisol-current-user', JSON.stringify(currentUser));
            hideAuth();
            document.getElementById('auth-prompt').style.display = 'none';
            
            // Clear form
            document.getElementById('email-input').value = '';
            document.getElementById('password-input').value = '';
            document.getElementById('name-input').value = '';
            
            renderCategories();
            updateStats();
        }

        function toggleStats() {
            showingStats = !showingStats;
            const statsSection = document.getElementById('stats-section');
            statsSection.style.display = showingStats ? 'grid' : 'none';
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Set current date
            document.getElementById('current-date').value = new Date().toISOString().split('T')[0];
            
            // Load saved user
            const savedUser = localStorage.getItem('cortisol-current-user');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                document.getElementById('auth-prompt').style.display = 'none';
            }
            
            // Load saved habits
            const savedHabits = localStorage.getItem('cortisol-habits');
            if (savedHabits) {
                habits = JSON.parse(savedHabits);
            }
            
            // Auto-detect language
            const browserLang = navigator.language.slice(0, 2);
            if (browserLang === 'ru') {
                setLanguage('ru');
            } else {
                updateUI();
            }
            
            // Date change handler
            document.getElementById('current-date').addEventListener('change', function() {
                renderCategories();
                updateStats();
            });
        });
    </script>
</body>
</html>
